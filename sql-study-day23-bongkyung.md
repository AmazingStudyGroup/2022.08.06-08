## 16 - 3 조건문

- 특정 조건식을 통해 상황에 따라 실행할 내용을 달리하는 방식의 명령어를 조건문이라고 한다.
- PL/SQL에서는 IF문과 CASE문을 사용할 수 있다.

<br/>

> IF 조건문

- PL/SQL에서 제공하는 IF 조건문 세 가지 방식을 사용할 수 있다.

| 종류 | 설명 |
|:------:|:------:|
| IF-THEN | 특정 조건을 만족하는 경우 작업 수행 |
| IF-THEN-ELSE | 특정 조건을 만족하는 경우와 반대 경우에 각각 지정한 작업 수행 |
| IF-THEN-ELSIF | 여러 조건에 따라 각각 지정한 작업 수행 |

#### IF-THEN

- 여러 프로그래밍 언어에서 사용하는 단일 IF문과 같은 역할을 하는 IF-THEN문은 다음과 같이 사용한다.
- 주어진 조건식의 결과 값이 true인 경우에는 작업을 수행하지만, false 또는 NULL일 경우에는 작업을 수행하지 않고 다음 내용을 실행한다.

```sql
// 기본 형식
IF 조건식 THEN // 1.
  수행할 명령어; // 2.
END IF; // 3.
```

| 번호 | 설명 |
|:----:|:----------:|
| 1. | true 또는 false 판별이 가능한 조건식을 지정합니다. 여러 연산자 및 함수를 사용할 수 있습니다. |
| 2. | 조건식의 결과 값이 true일 때 실행할 명령어를 지정합니다. 여러 명령어 지정이 가능합니다. |
| 3. | IF를 종료합니다. |

<br/>

#### IF-THEN-ELSE

- IF-THEN-ELSE문은 지정한 조건식의 결과 값이 true일 경우에 실행할 명렁어와 조건식의 결과 값이 true가 아닐 때 실행할 명령어를 각각 지정할 수 있다.

```sql
// 기본 형식
IF 조건식 THEN // 1.
  수행할 명렁어; // 2.
ELSE
  수행할 명령어; // 3.
END IF;  // 4.
```

| 번호 | 설명 |
|:---:|:--------------:|
| 1. | true 또는 false 판별이 가능한 조건식을 지정합니다. 여러 연산자 및 함수 사용이 가능합니다. |
| 2. | 조건식의 결과 값이 true일 경우 실행할 명령어를 지정합니다. 여러 명령어 지정이 가능합니다. |
| 3. | 조건식의 결과 값이 true가 아닐 경우 실행할 명령어를 지정합니다. 여러 명령어 지정이 가능합니다. |
| 4. | IF를 종료합니다. |

<br/>

> IF-THEN-ELSIF

- 결과 값이 true인지 아닌지 여부에 따라 두 가지 상황을 구현할 수 있는 IF-THEN-ELSE문과 달리 IF-THEN-ELSIF문은 여러 종류의 조건을 지정하여 각 조건을 만족하는 경우마다 다른 작업의 수행을 지정하는 것이 가능하다.

```sql
// 기본 형식
IF 조건식 THEN // 1.
  수행할 명령어; // 2.
ELSIF 조건식 // 3.
  수행할 명령어; // 4.
ELSIF // 5.
  수행할 명령어; // 6.
...
ELSE // 7.
  수행할 명령어; // 8.
END IF; // 9.
```

| 번호 | 설명 |
|:-----:|:----------------:|
| 1~2 | 1 조건식의 결과 값이 true이면 2 명령어를 수행하고(다음 ELSIF 및 ELSE문은 실행되지 않음) 조건식의 결과 값이 false면 다음 ELSIF 조건식으로 넘어갑니다. |
| 3~6 | 3 조건식의 결과 값이 true이면 4 명령어를 수행하고(다음 ELSIF 및 ELSE문은 실행되지 않음) 조건식의 결과 값이 false이면 다음 ELSIF 또는 ELSE로 넘어갑니다. 5, 6 과정도 같습니다. |
| 7~8 | 7 위 IF, ELSIF 조건식의 결과 값이 어디에서도 true가 나오지 않는다면 8 명령어를 수행합니다. |
| 9 | IF를 종료합니다. |

<br/>

> CASE 조건문

- CASE 조건문도 IF조건문과 마찬가지로 조건식의 결과 값에 따라 여러 가지 수행 작업을 지정할 수 있다.
- IF-THEN-ELSIF문과 같이 조건식의 결과 값이 여러 가지일 때 CASE조건문을 좀 더 단순하게 표현할 수 있다.
- CASE 조건문은 두 가지 방식을 사용한다.

| 종류 | 설명 |
|:-----:|:----------:|
| 단순 CASE문 | 비교 기준이 되는 조건의 값이 여러 가지일 때 해당 값만 명시하여 작업 수행 |
| 검색 CASE문 | 특정한 비교 기준 없이 여러 조건식을 나열하여 조건식에 맞는 작업 수행 |

#### 단순 CASE

- 단순 CASE문은 비교 기준(여러 가지 결과 값이 나올 수 있는)이 되는 변수 또는 식을 명시한다. 그리고 각 결과 값에 따라 수행할 작업을 지정한다.

```sql
// 기본 형식
CASE 비교 기준 // 1.
  WHEN 값1 THEN // 2.
    수행할 명령어; // 3.
  WHEN 값2 THEN // 4.
    수행할 명령어; // 5.
  ...
  ELSE // 6.
    수행할 명령어; // 7.
END CASE; // 8.
```

| 번호 | 설명 |
|:----:|:---------------:|
| 1. | 1 먼저 여러 결과 값이 나올 수 있는 비교 기준을 지정합니다. 변수 또는 여러 표현식을 지정할 수 있습니다. |
| 2~5 | 2 비교 기준의 결과 값이 1과 일치하면 3 작업을 수행하고 나머지 명령어를 건너뜁니다. 4, 5 역시 같습니다. |
| 6~7 | 6 위의 WHEN에 일치하는 값을 찾지 못한다면 마지막으로 ELSE에 지정한 7 작업을 수행합니다. |
| 8. | CASE문을 끝냅니다. |

<br/>

#### 검색 CASE

- 검색 CASE문은 비교 기준을 명시하지 않고 각각의 WHEN 절에서 조건식을 명시한 후 해당 조건을 만족할 때 수행할 작업을 정해 준다.

```sql
// 기본 형식
CASE
  WHEN 조건식1 THEN // 1.
    수행할 명령어; // 2.
  WHEN 조건식2 THEN // 3.
    수행할 명령어; // 4.
  ...
  ELSE // 5.
    수행할 명령어; // 6.
  END CASE;
```

| 번호 | 설명 |
|:-----:|:------------:|
| 1~4 | 1 조건식1의 결과 값이 true라면 2 작업을 수행합니다. 나머지 명령어는 건너뜁니다. 3, 4로 표현한 다른 WHEN절 역시 동일하게 동작합니다. |
| 5~6 | 5 먼저 실행한 WHEN절의 조건식을 만족하는 경우가 없다면 6 작업을 수행합니다. |

<br/>

## 16 - 4 반복 제어문

- 반복문은 특정 작업을 반복하여 수행하고자 할 때 사용한다.

| 종류 | 설명 |
|:-----:|:----------:|
| 기본 LOOP | 기본 반복문 |
| WHILE LOOP | 특정 조건식의 결과를 통해 반복 수행 |
| FOR LOOP | 반복 횟수를 정하여 반복 수행 |
| Cusor FOR LOOP | 커서를 활용한 반복 수행 |

- 반복 수행을 중단시키거나 특정 반복 주기를 건너뛰는 명령어

| 종류 | 설명 |
|:------:|:--------------:|
| EXIT | 수행 중인 반복 종료 |
| EXIT-WHEN | 반복 종료를 위한 조건식을 지정하고 만족하면 반복 종료 |
| CONTINUE | 수행 중인 반복의 현재 주기를 건너뜀 |
| CONTINUE-WHEN | 특정 조건식을 지정하고 조건식을 만족하면 현재 반복 주기를 건너뜀 |

<br/>

> 기본 LOOP

```sql
// 기본 형식
LOOP
  반복 수행 작업;
END LOOP;
```

- 기본 LOOP문은 반복의 종료 시점이나 조건식을 따로 명시하지 않으므로 지정한 작업을 무한히 반복 수행하게 된다. 이러한 현상을 무한 루프(Infinite Loop)라고 한다.
- 수행 작업을 무한 반복해야 하는 경우는 많지 않으므로 대부분의 기본 LOOP문은 반복을 종료하는 EXIT 명령어를 함께 사용한다.

<br/>

> WHILE LOOP

- WHILE LOOP문은 반복 수행 여부를 결정하는 조건식을 먼저 지정한 후 조건식의 결과 값이 true일 대 조건을 반복하고 false가 되면 반복을 끝낸다.

```sql
// 기본 형식
WHILE 조건식 LOOP
  반복 수행 작업;
END LOOP;
```

- WHILE LOOP문은 반복 수행이 시작되기 전에 조건식을 검사하므로 조건식의 결과 값에 따라 단 한 번도 반복 수행되지 않을 수도 있음을 기억하세요.

<br/>

> FOR LOOP

- FOR LOOP문은 반복의 횟수를 지정할 수 있는 반복문이다.
- 지정한 시작 값부터 1씩 증가하여 종료 값에 이를 때까지 작업을 반복 수행한다.
- FOR 키워드 다음에 작성한 i는 반복 수행 중의 시작 값과 종료 값 사이의 현재 숫자가 저장되는 특수한 변수로 카운터(counter)라고 한다.
- 카운터는 선언부에 정의하지 않고 FOR LOOP문에서 바로 정의하여 사용한다.
- FOR LOOP문 안에서만 사용 가능하며, 값을 임의로 할당할 수 없고 현재 저장되어 있는 값을 참조만 할 수 있다.

```sql
// 기본 형식
FOR i IN 시작 값 .. 종료 값 LOOP
  반복 수행 작업;
END LOOP;
```

- 시작 값에서 종료 값을 역순으로 반복하고 싶다면 다음과 같이 REVERSE 키워드를 사용한다.
- FOR LOOP문에 사용하는 시작 값과 종료 값의 위치는 변하지 않으므로 주의하자.

```sql
// 기본 형식
FOR i IN REVERSE 시작 값 .. 종료 값 LOOP
  반복 수행 작업;
END LOOP;
```

<br/>

> CONTINUE문, CONTINUE-WHEN문

- CONTINUE문과 CONTINUE-WHEN문은 오라클 11g 버전부터 사용할 수 있다.
- 반복 수행 중 CONTINUE가 실행되면 현재 반복 주기에 수행해야 할 남은 작업을 건너뛰로 다음 반복 주기로 바로 넘어가는 효과가 있다.
- EXIT, EXIT-WHEN문과 마찬가지로 CONTINUE는 즉시 다음 반복 주기로 넘어가고, CONTINUE-WHEN문은 특정 조건식을 만족할 때 다음 반복 주기로 넘어가게 된다.

---
